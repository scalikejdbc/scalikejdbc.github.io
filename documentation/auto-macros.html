<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <!-- Use title if it's in the page YAML frontmatter -->
    <title>Auto Macros - ScalikeJDBC</title>
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"/>
    <script type="text/javascript" src="//code.jquery.com/jquery-1.11.0.min.js"></script>
    <link href="/stylesheets/all.css" rel="stylesheet" />
    <script src="/javascripts/all.js"></script>
  </head>
  <body>
    <div class="container">
    <div class="navbar" role="navigation" id="header">
      <div class="container">
        <div class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li><a class="navbar-brand" href="/">ScalikeJDBC</a></li>
            <li><a href="https://groups.google.com/group/scalikejdbc-users-group">Users Group</a></li>
            <li><a href="https://github.com/scalikejdbc/scalikejdbc">GitHub</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>
    <div class="col-xs-6 pull-right" style="height:50px;">
      <gcse:searchbox-only></gcse:searchbox-only>
    </div>
      <div class="col-xs-9 left">
        <div class="content">
          <h2 id="auto-macros">Auto Macros</h2>

<hr/>

<h3 id="avoid-boilerplate-code">Avoid Boilerplate Code</h3>

<hr/>

<p>If you want to avoid writing lots of boilerplate code, <code>scalikejdbc-syntax-support-macro</code> can be greatly helpful for reducing such troublesome coding tasks.</p>

<hr/>

<h3 id="setup">Setup</h3>

<hr/>

<p>In addition to the core library, you can add the following optional dependency in <code>buid.sbt</code>:</p>
<div class="highlight"><pre class="highlight scala"><code><span class="n">libraryDependencies</span> <span class="o">+=</span> <span class="s">"org.scalikejdbc"</span> <span class="o">%%</span> <span class="s">"scalikejdbc-syntax-support-macro"</span> <span class="o">%</span> <span class="s">"4.3.0"</span>
</code></pre></div>
<hr/>

<h3 id="usage">Usage</h3>

<hr/>

<h4 id="autoconstruct-for-extracting-entities-from-resultset">autoConstruct for extracting entities from ResultSet</h4>

<p>When you don&rsquo;t use the macros, the usual code to extract data from <code>ResultSet</code> should look like below:</p>
<div class="highlight"><pre class="highlight scala"><code><span class="k">case</span> <span class="k">class</span> <span class="nc">Company</span><span class="o">(</span>
  <span class="n">id</span><span class="k">:</span> <span class="kt">Long</span><span class="o">,</span>
  <span class="n">name</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> 
  <span class="n">countryId</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Long</span><span class="o">],</span>
  <span class="n">country</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Country</span><span class="o">]</span> <span class="k">=</span> <span class="nc">None</span>
<span class="o">)</span>

<span class="k">object</span> <span class="nc">Company</span> <span class="k">extends</span> <span class="nc">SQLSyntaxSupport</span><span class="o">[</span><span class="kt">Company</span><span class="o">]</span> <span class="o">{</span>

  <span class="k">def</span> <span class="nf">apply</span><span class="o">(</span><span class="n">rs</span><span class="k">:</span> <span class="kt">WrappedResultSet</span><span class="o">,</span> <span class="n">rn</span><span class="k">:</span> <span class="kt">ResultName</span><span class="o">[</span><span class="kt">Company</span><span class="o">])</span><span class="k">:</span> <span class="kt">Company</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Company</span><span class="o">(</span>
    <span class="n">id</span> <span class="k">=</span> <span class="nv">rs</span><span class="o">.</span><span class="py">get</span><span class="o">(</span><span class="nv">rn</span><span class="o">.</span><span class="py">id</span><span class="o">),</span> 
    <span class="n">name</span> <span class="k">=</span> <span class="nv">rs</span><span class="o">.</span><span class="py">get</span><span class="o">(</span><span class="nv">rn</span><span class="o">.</span><span class="py">name</span><span class="o">),</span> 
    <span class="n">countryId</span> <span class="k">=</span> <span class="nv">rs</span><span class="o">.</span><span class="py">get</span><span class="o">(</span><span class="nv">rn</span><span class="o">.</span><span class="py">countryId</span><span class="o">)</span>
  <span class="o">)</span>
<span class="o">}</span>
</code></pre></div>
<p>When using scalikejdbc-syntax-support-macro, you can use <code>#autoConstruct</code> macro instead. As you can see, now the code is significantly simpler and much easier to maintain for the future.</p>
<div class="highlight"><pre class="highlight scala"><code><span class="k">case</span> <span class="k">class</span> <span class="nc">Company</span><span class="o">(</span>
  <span class="n">id</span><span class="k">:</span> <span class="kt">Long</span><span class="o">,</span>
  <span class="n">name</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> 
  <span class="n">countryId</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Long</span><span class="o">],</span>
  <span class="c1">// This property never comes from ResultSet</span>
  <span class="n">country</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Country</span><span class="o">]</span> <span class="k">=</span> <span class="nc">None</span>
<span class="o">)</span>

<span class="k">object</span> <span class="nc">Company</span> <span class="k">extends</span> <span class="nc">SQLSyntaxSupport</span><span class="o">[</span><span class="kt">Company</span><span class="o">]</span> <span class="o">{</span>

  <span class="k">def</span> <span class="nf">apply</span><span class="o">(</span><span class="n">rs</span><span class="k">:</span> <span class="kt">WrappedResultSet</span><span class="o">,</span> <span class="n">rn</span><span class="k">:</span> <span class="kt">ResultName</span><span class="o">[</span><span class="kt">Company</span><span class="o">])</span><span class="k">:</span> <span class="kt">Company</span> <span class="o">=</span> 
    <span class="c1">// "country" is execluded when binding values from ResultSet</span>
    <span class="c1">// Note that the property neeeds to have the default `None` value</span>
    <span class="nf">autoConstruct</span><span class="o">(</span><span class="n">rs</span><span class="o">,</span> <span class="n">rn</span><span class="o">,</span> <span class="s">"country"</span><span class="o">)</span>
<span class="o">}</span>
</code></pre></div>
<p>The <code>#autoConstruct</code> method binds all the fields defined at the primary constructor automatically.</p>

<p>The <code>country</code> field in the above example class should be ignored. In such cases, you should specify an additional String parameter such as &ldquo;country&rdquo;. Of course, the &ldquo;country&rdquo; will be verified at Scala compilation time!</p>

<hr/>

<h4 id="autocolumns-to-avoid-accessing-jdbc-metadata">autoColumns to avoid accessing JDBC metadata</h4>

<p>When your code loads ScalikeJDBC DAO objects, ScalikeJDBC automatically fetches all the column names for the table specified by <code>SQLSyntaxSupport</code>&lsquo;s <code>tableName</code> via the JDBC metadata API.</p>

<p>If you don&rsquo;t prefer the behavior, you can choose to load column names from the entity class&rsquo;s field names instead. The following code won&rsquo;t access JDBC metadata and will resolve column names from the <code>Company</code> class&rsquo;s fields and primary constructor&rsquo;s parameters by simply converting them to snake-cased ones or applying name converters to them.</p>
<div class="highlight"><pre class="highlight scala"><code><span class="k">case</span> <span class="k">class</span> <span class="nc">Company</span><span class="o">(</span><span class="n">id</span><span class="k">:</span> <span class="kt">Long</span><span class="o">,</span> <span class="n">name</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">countryId</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Long</span><span class="o">],</span> <span class="n">country</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Country</span><span class="o">]</span> <span class="k">=</span> <span class="nc">None</span><span class="o">)</span>

<span class="k">object</span> <span class="nc">Company</span> <span class="k">extends</span> <span class="nc">SQLSyntaxSupport</span><span class="o">[</span><span class="kt">Company</span><span class="o">]</span> <span class="o">{</span>

  <span class="k">override</span> <span class="k">lazy</span> <span class="k">val</span> <span class="nv">columns</span> <span class="k">=</span> <span class="n">autoColumns</span><span class="o">[</span><span class="kt">Company</span><span class="o">](</span><span class="s">"country"</span><span class="o">)</span> 
  <span class="c1">// this will be Seq("id", "name", "country_id")</span>
<span class="o">}</span>
</code></pre></div>
          <hr/>
          <div class="alert alert-warning small">
            If this webpage has a typo or something wrong, Please report or fix it. <a href="/contribution.html">How?</a>
          </div>
        </div>
      </div>

      <div class="col-xs-3 right">
        <div class="content small">
          <h5>Latest version</h5>
          <hr/>
          <p><a href="/documentation/setup.html">Setup</a></p>
          <p><a href="/documentation/configuration.html">Configuration</a></p>
          <p><a href="/documentation/connection-pool.html">Connection Pool</a></p>
          <p><a href="/documentation/operations.html">Operations</a></p>
          <p><a href="/documentation/transaction.html">Transaction</a></p>
          <p><a href="/documentation/auto-session.html">Auto Session</a></p>
          <p><a href="/documentation/sql-interpolation.html">SQLInterpolation</a></p>
          <p><a href="/documentation/query-dsl.html">QueryDSL</a></p>
          <p><a href="/documentation/one-to-x.html">One-to-x API</a></p>
          <p><a href="/documentation/auto-macros.html">Auto Macros</a></p>
          <p><a href="/documentation/query-inspector.html">Logging / Query Inspector</a></p>
          <p><a href="/documentation/reverse-engineering.html">Reverse Engineering</a></p>
          <p><a href="/documentation/testing.html">Testing</a></p>
          <p><a href="/documentation/playframework-support.html">Play Framework</a></p>
          <p><a href="/documentation/reactivestreams-support.html">Reactive Streams</a></p>
          <p><a href="/documentation/dbconsole.html">dbconsole</a></p>
          <p><a href="https://www.javadoc.io/doc/org.scalikejdbc/scalikejdbc-core_2.13/4.3.0">Core API Doc</a></p>
          <p><a href="/documentation/faq.html">FAQ</a></p>
          <p><a href="/documentation/testimonials.html">Testimonials</a></p>
          <p><a href="/contribution.html">Contribution</a></p>
          <hr/>
          <h5>Older Versions</h5>
          <hr/>
          <p><a href="/documentation/2.x/">version 2.x</a></p>
          <p><a href="/documentation/1.x/">version 1.x</a></p>
        </div>
      </div>
    </div>
    </div>
    <script type="text/javascript" src="//netdna.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <script>
(function() {
var cx = '000372347144050476309:fnw5lotlq6o';
var gcse = document.createElement('script');
gcse.type = 'text/javascript';
gcse.async = true;
gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//cse.google.com/cse.js?cx=' + cx;
var s = document.getElementsByTagName('script')[0];
s.parentNode.insertBefore(gcse, s);
})();
</script>
  </body>
</html>
